# 小項目: 用戶註冊登陸

## 功能
- 註冊
- 登陸

## JSP
- login.jsp -> 登陸表單
- regist.jsp -> 註冊表單
- index.jsp -> 主頁(只有登陸成功才能看到)

## Servlet
- LoginServlet
- RegistServlet

## Service
- UseerService -> 與用戶相關的業務類

## Dao
- UserDao -> 與用戶相關的數據類

## Domain
- User (對應數據庫，還要對應所有表單)
    - username
    - password
    - verifyCode
    

## 數據庫設計
- users.xml
    
    ```xml
    <users>
        <user username="xxx" password="xxx"/>
        <user username="xxx" password="xxx"/>
    <users>
    ```

## 步驟
- 創建空項目
- 導包:
    - CommonUtils
    - commons-beanutils.jar
    - commons-logging.jar
    - dom4j
- 建包
    - user.domain
        - User
    - user.dao
        - UserDao
    - user.service
        - UserService 
    - user.web.servlet
        - LoginServlet
        - RegistServlet
- JSP
    - login.jsp
    - regist.jsp
    - index.jsp
- 在C盤下創建一個 users.xml 文件。
    - 添加根元素 &lt;users&gt;
    - 保證文件為 utf-8 編碼。
    

## 註冊
- regist.jsp
    - 第一步: 完成 regist.jsp 的基本功能。
- RegistServlet
    - 封裝表單數據，封裝到 User 對象中。
    - 調用 service 的 regist() 方法。
        - 如果這個方法沒有出問題，給頁面顯示成功信息(輸出"註冊成功")。
        - 如果這個方法拋出了異常，把錯誤信息保存到 request 域，轉發到 regist.jsp(顯示錯誤信息)。
- UserService$regis()
    - 沒有返回值，但註冊失敗拋出一個自定義的異常。可以在異常中添加異常信息(自定義一個異常類)。
    - 校驗用戶名是否已被註冊(通過用戶名查詢用戶)，如果已被註冊，拋出異常，異常信息為"用戶名已被註冊!"。
    - 添加用戶
- UserDao: 通過業務分析，得到結果，需要提供兩個方法
    - 按用戶名查詢用戶對象: User findByUsername(String username)
    - 插入一個用戶到數據庫中: void add(User user)

## 註冊流程圖
![](https://github.com/jack870131/Markdown-Pic/blob/master/Picture/%E7%94%A8%E6%88%B6%E8%A8%BB%E5%86%8A%E7%99%BB%E9%99%B8.png)
    
## 工作
- 在 service 層添加一個 UserException
- Dao:
    - User findByUsername(String username)
    - void add(User user)
- Service:
    - void regist() throws UserException
- Servlet
    - 封裝表單數據到 User 對象中。
    - 使用 user 調用 service 的 regist() 方法
    - 如果得到 UserException, 那麼把異常信息保存到 request 域中，轉發回 regist.jsp。
    - 輸出"註冊成功"。

## 給註冊添加驗證碼
- VerifyCode 類
    - BufferedImage getImage() -> 獲取隨機的驗證碼圖片
    - String getText() -> 獲取圖片上的文本
    - static output(BufferedImage, OutputStream) -> 把圖片寫入到指定的輸出流中。
- VerifyCodeServlet
    - 獲取隨機驗證碼圖片
    - 把驗證碼圖片上的文本保存到 session 中
    - 把圖片響應到 response 的 OutputStream 中
- regist.jsp
    - 添加 &lt;img src="指向Servlet"/&gt;
    - 添加一個文本框，用來輸入驗證碼
    - "看不清，換一長"，是一個超鏈接。把上面的 &lt;img&gt; 的 src 重新再次指向 Servlet。為了處理瀏覽器的緩存，需要使用時間來做參數。
- 修改 RegistServlet
    - 校驗驗證碼
    - 錯誤: 保存表單數據到 request 域、保存錯誤信息到 request 域，轉發回 regist.jsp
    - 正確: 什麼都不做，向下執行原來代碼。
    

## 服務器端表單(輸入校驗)
放到獲取表單數據之後，驗證碼之前。
- 使用 Map 類型來裝載錯誤信息。
    - key: 表單項名稱，例如: username, password, verifyCode
    - value: 
        - 非空: 用戶名不能為空，或者是"密碼不能為空"。
        - 長度: 用戶名長度必須要 3-20 之間，密碼長度必須在 3-20 之間。
        
- 在校驗失敗時，向 map 添加錯誤信息。哪個字段出錯，就給哪個字段添加錯誤信息。
- 判斷 map 是否為空(長度是否為0)，如果不空，說明有錯誤存在，保存 map 到 request 域，保存 form 到 request 域(回顯)，轉發回 regist.jsp。
- 在 regist.jsp 頁面中，顯示 map 中的錯誤信息。${map.username}

## 登錄功能
- 頁面: login.jsp -> 登錄表單
- LoginServlet ->
    - 獲取表單數據，封裝到 User 中
    - 調用 service 的 login() 方法，傳遞 form 過去。
    - 如果 service 的 login() 方法，沒有拋出異常，返回一個 User 對象。
    - 有異常: 獲取異常信息，保存到 request 域，保存 form, 轉發到 login.jsp
    - 沒異常: 保存返回的 user 對象到 session 中。重定向到 welcome.jsp(顯示當前用戶信息)。

- UserService#login()
    public User login(User form) {...}
使用用戶名查詢數據庫，得到返回的User。
    - 返回為 null，拋出異常，異常信息為(用戶名不存在)
    - 返回不為 null，獲取查詢出來的 user 的 password 與 form 的 password 進行比較。如果不同: 拋出異常(密碼錯誤)
    - 如果相同，返回查詢結果。

- UserDao
    - 通過用戶名查詢用戶。(已經存在了，不用再寫)
    

## 代碼實現
```java
//User.java
package user.domain;

public class User {
	private String username;
	private String password;
	private String verifyCode;
	public User() {
		super();
	}
	public String getUsername() {
		return username;
	}
	public void setUsername(String username) {
		this.username = username;
	}
	public String getPassword() {
		return password;
	}
	public void setPassword(String password) {
		this.password = password;
	}
	public String getVerifyCode() {
		return verifyCode;
	}
	public void setVerifyCode(String verifyCode) {
		this.verifyCode = verifyCode;
	}
	@Override
	public String toString() {
		return "User [username=" + username + ", password=" + password + ", verifyCode=" + verifyCode + "]";
	}
}

//UserException.java
package user.service;

/**
 * 自定義一個異常類
 * 	只是給出父類中的構造器即可，方便用來創建對象
 * @author jack870131
 *
 */
public class UserException extends Exception {

	public UserException() {
		super();
		// TODO Auto-generated constructor stub
	}

	public UserException(String message, Throwable cause) {
		super(message, cause);
		// TODO Auto-generated constructor stub
	}

	public UserException(String message) {
		super(message);
		// TODO Auto-generated constructor stub
	}

	public UserException(Throwable cause) {
		super(cause);
		// TODO Auto-generated constructor stub
	}

}


//UserDao.java
package user.dao;

import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.OutputStreamWriter;
import java.io.UnsupportedEncodingException;

import org.dom4j.Document;
import org.dom4j.DocumentException;
import org.dom4j.Element;
import org.dom4j.io.OutputFormat;
import org.dom4j.io.SAXReader;
import org.dom4j.io.XMLWriter;

import user.domain.User;

/**
 * UserDao 層
 * @author jack870131
 *
 */
public class UserDao {
	private String path = "C:/Users/asus/Documents/Java/Java Web/users.xml"; //依賴數據文件
	
	/**
	 * 按用戶名查詢
	 * @param username
	 * @return
	 */
	public User findByUserName(String username) {
		/*
		 * 1. 得到 Document
		 * 2. xpath 查詢
		 * 3. 校驗查詢結果是否為 null, 如果為 null, 返回 null
		 * 4. 如果不為 null, 需要把 Element 封裝到 User 對象中。
		 */
		
		/*
		 * 1. 得到 Document
		 */
		//創建解析器
		SAXReader reader = new SAXReader();
		try {
			Document doc = reader.read(path);
			/*
			 * 2. 通過 xpath 查詢得到 Element
			 */
			Element ele = (Element) doc.selectSingleNode("//user[@username='" + username + "']");
			/*
			 * 3. 校驗 ele 是否為 null, 如果為 null, 返回 null
			 */
			if(ele == null) {
				return null;
			}
			/*
			 * 4. 把 ele 的數據封裝到 User 對象中
			 */
			User user = new User();
			String attrUsername = ele.attributeValue("username"); //獲取該元素名稱為 username 屬性值
			String attrPassword = ele.attributeValue("password"); //獲取該元素名稱為 password 屬性值
			user.setUsername(attrUsername);
			user.setUsername(attrPassword);	
			
			return user;
		} catch (DocumentException e) {
			throw new RuntimeException(e);
		}
	}
	
	/**
	 * 添加用戶
	 * @param user
	 */
	public void add(User user) {
		/*
		 * 1. 得到 Document
		 * 2. 通拓 Document 得到 root 元素。<users>
		 * 3. 使用參數 user, 轉發成 Element 對象。
		 * 4. 把 element 添加到 root 元素中。
		 * 5. 保存 Document
		 */
		
		//得到 Document
		SAXReader reader = new SAXReader();
		try {
			Document doc = reader.read(path);
			// 得到根元素
			Element root = doc.getRootElement();
			// 通過根元素創建新元素
			Element userEle = root.addElement("user");
			//為 userEle 設置屬性
			userEle.addAttribute("username", user.getUsername());
			userEle.addAttribute("password", user.getPassword());
			
			/*
			 * 保存文檔
			 */
			//創建輸出格式化器
			OutputFormat format = new OutputFormat("\t", true); //鎖進使用 \t, 是否換行(是)
			format.setTrimText(true); //清空原有的換行和縮進
			
			//創建 XmlWriter
			XMLWriter writer;
			try {
				writer = new XMLWriter(
						new OutputStreamWriter(
								new FileOutputStream(path), "utf-8"), format);
				writer.write(doc); //保存 document 對象
				writer.close();
			} catch (Exception e) {
				throw new RuntimeException(e);
			}
		} catch (DocumentException e) {
			throw new RuntimeException(e);
		}
	}
}

//UserService.java
package user.service;

import user.dao.UserDao;
import user.domain.User;

/**
 * User 的業務邏輯層
 * @author jack870131
 *
 */
public class UserService {
	private UserDao userDao = new UserDao();
	
	/**
	 * 註冊功能
	 * @param user
	 * @throws UserException
	 */
	public void regist(User user) throws UserException {
		/*
		 * 1. 使用用戶名去查詢，如果返回 null, 完成添加
		 * 2. 如果返回的不是 null, 拋出異常
		 */
		User _user = userDao.findByUserName(user.getUsername());
		if(_user != null) {
			throw new UserException("用戶名" + user.getUsername() + ", 已被註冊");
		} else {
			userDao.add(user);
		}
	}

	/**
	 * 登錄功能
	 * @param form
	 * @return
	 * @throws UserException 
	 */
	public User login(User form) throws UserException {
		/*
		 * 1. 使用 form 中的 username 進行查詢，得到 User user
		 */
		User user = userDao.findByUserName(form.getUsername());
		/*
		 * 2. 如果返回 null, 說明用戶名不存在，拋出異常，異常信息為"用戶名不存在!"
		 */
		if(user == null) {
			throw new UserException("用戶名不存在!");
		}
		/*
		 * 3. 比較 user 的 password 和 form 的 password, 如果不同，拋出異常，異常信息為"密碼錯誤!"
		 */
		if(form.getPassword().equals(user.getPassword())) {
			throw new UserException("密碼錯誤!");
		}
		/*
		 * 返回數據庫中查詢出來的 user, 而不是 form, 因為 form 中只有用戶名和密碼，而 user 是所有用戶信息
		 */
		return user;
	}
}

//LoginServlet
package user.web.servlet;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import cn.itcast.commons.CommonUtils;
import user.domain.User;
import user.service.UserException;
import user.service.UserService;

/**
 * UserServlet 層
 * @author jack870131
 *
 */
public class LoginServlet extends HttpServlet {

	public void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		request.setCharacterEncoding("utf-8"); //請求編碼(POST)
		response.setContentType("text/html;charset=utf-8"); //響應編碼
		
		//依賴 UserService
		UserService userService = new UserService();
		
		/*
		 * 1. 封裝表單數據到 User form 中
		 * 2. 調用 UserService 的 login() 方法，得到返回的 User user 對象
		 * 	  - 如果拋出異常: 獲取異常，保存到 request 域，再保存到 form, 轉發到 login.jsp
		 * 	  - 如果沒有異常: 保存返回直到 session 中，重定向到 welcome.jsp
		 */
		User form = CommonUtils.toBean(request.getParameterMap(), User.class);
		try {
			User user = userService.login(form);
			request.getSession().setAttribute("sessionUser", user);
			response.sendRedirect(request.getContextPath() + "/user/welcome.jsp");
		} catch(UserException e) {
			request.setAttribute("msg", e.getMessage());
			request.setAttribute("user", form);
			request.getRequestDispatcher("/user/login.jsp").forward(request, response);
		}
	}

}

//RegistServlet
package user.web.servlet;

import java.io.IOException;
import java.util.HashMap;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import cn.itcast.commons.CommonUtils;
import user.domain.User;
import user.service.UserException;
import user.service.UserService;

public class RegistServlet extends HttpServlet {

	public void doPost(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		request.setCharacterEncoding("utf-8");
		response.setContentType("text/html;charset=utf-8");
		
		// 依赖UserServlet
		UserService userService = new UserService();
		
		/*
		 * 1. 封装表单数据（封装到User对象中）
		 */
		User form = CommonUtils.toBean(request.getParameterMap(), User.class);
		
		
		/*
		 * 添加新任务（表单校验）
		 * 1. 创建一个Map，用来装载所有的表单错误信息
		 *   在校验过程中，如果失败，向map添加错误信息，其中key为表单字段名称
		 * 2. 校验之后，查看map长度是否大于0，如果大于0，说明有错误信息，就是有错误！
		 *   > 保存map到request中，保存form到request中，转发到regist.jsp
		 * 
		 * 3. 如果map为空，说明没有错误信息，向下执行！
		 */
		
		// 用来装载所有错误信息
		HashMap<String,String> errors = new HashMap<>();
		
		// 对用户名进行校验
		String username = form.getUsername();//获取表单的username
		if(username == null || username.trim().isEmpty()) {
			errors.put("username", "用户名不能为空！");
		} else if(username.length() < 3 || username.length() > 15) {
			errors.put("username", "用户名长度必须在3~15之间！");
		}
		
		// 对密码进行校验
		String password = form.getPassword();
		if(password == null || password.trim().isEmpty()) {
			errors.put("password", "密码不能为空！");
		} else if(password.length() < 3 || password.length() > 15) {
			errors.put("password", "密码长度必须在3~15之间！");
		}
		
		
		// 对验证码进行校验
		String sessionVerifyCode = (String) request.getSession().getAttribute("session_vcode");
		String verifyCode = form.getVerifyCode();
		if(verifyCode == null || verifyCode.trim().isEmpty()) {
			errors.put("verifyCode", "验证码不能为空！");
		} else if(verifyCode.length() != 4) {
			errors.put("verifyCode", "验证码长度必须为4！");
		} else if(!verifyCode.equalsIgnoreCase(sessionVerifyCode)) {
			errors.put("verifyCode", "验证码错误！");
		}
		
		/*
		 * 判断map是否为空，不为空，说明存在错误
		 */
		if(errors != null && errors.size() > 0) {
			/*
			 * 1. 保存errors到request域
			 * 2. 保存form到request域，为了回显
			 * 3. 转发到regist.jsp
			 */
			request.setAttribute("errors", errors);
			request.setAttribute("user", form);
			request.getRequestDispatcher("/user/regist.jsp").forward(request, response);
			return;
		}
		
		
		
		/*
		 * 2. 调用userService的regist()方法，传递form过去
		 * 3. 得到异常：获取异常信息，保存到request域，转发到regist.jsp中显示
		 * 4. 没有异常：输出注册成功！
		 */
		try {
			userService.regist(form);
			response.getWriter().print("<h1>注册成功！</h1><a href='" + 
					request.getContextPath() + 
					"/user/login.jsp" + "'>点击这里去登录</a>");
		} catch (UserException e) {
			// 获取异常信息，保存到request域
			request.setAttribute("msg", e.getMessage());
			// 还要保存表单数据，到request域
			request.setAttribute("user", form);//用来在表单中回显！
			// 转发到regist.jsp
			request.getRequestDispatcher("/user/regist.jsp").forward(request, response);
		}
	}
}

//VerifyCode.java
package user.web.servlet;

import java.awt.BasicStroke;
import java.awt.Color;
import java.awt.Font;
import java.awt.Graphics2D;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.io.OutputStream;
import java.util.Random;

import javax.imageio.ImageIO;

public class VerifyCode {
	private int w = 70;
	private int h = 35;
 	private Random r = new Random();
 	// {"宋体", "华文楷体", "黑体", "华文新魏", "华文隶书", "微软雅黑", "楷体_GB2312"}
	private String[] fontNames  = {"宋体", "华文楷体", "黑体", "微软雅黑", "楷体_GB2312"};
	// 可选字符
	private String codes  = "23456789abcdefghjkmnopqrstuvwxyzABCDEFGHJKMNPQRSTUVWXYZ";
	// 背景色
	private Color bgColor  = new Color(255, 255, 255);
	// 验证码上的文本
	private String text ;
	
	// 生成随机的颜色
	private Color randomColor () {
		int red = r.nextInt(150);
		int green = r.nextInt(150);
		int blue = r.nextInt(150);
		return new Color(red, green, blue);
	}
	
	// 生成随机的字体
	private Font randomFont () {
		int index = r.nextInt(fontNames.length);
		String fontName = fontNames[index];//生成随机的字体名称
		int style = r.nextInt(4);//生成随机的样式, 0(无样式), 1(粗体), 2(斜体), 3(粗体+斜体)
		int size = r.nextInt(5) + 24; //生成随机字号, 24 ~ 28
		return new Font(fontName, style, size);
	}
	
	// 画干扰线
	private void drawLine (BufferedImage image) {
		int num  = 3;//一共画3条
		Graphics2D g2 = (Graphics2D)image.getGraphics();
		for(int i = 0; i < num; i++) {//生成两个点的坐标，即4个值
			int x1 = r.nextInt(w);
			int y1 = r.nextInt(h);
			int x2 = r.nextInt(w);
			int y2 = r.nextInt(h); 
			g2.setStroke(new BasicStroke(1.5F)); 
			g2.setColor(Color.BLUE); //干扰线是蓝色
			g2.drawLine(x1, y1, x2, y2);//画线
		}
	}
	
	// 随机生成一个字符
	private char randomChar () {
		int index = r.nextInt(codes.length());
		return codes.charAt(index);
	}
	
	// 创建BufferedImage
	private BufferedImage createImage () {
		BufferedImage image = new BufferedImage(w, h, BufferedImage.TYPE_INT_RGB); 
		Graphics2D g2 = (Graphics2D)image.getGraphics(); 
		g2.setColor(this.bgColor);
		g2.fillRect(0, 0, w, h);
 		return image;
	}
	
	// 调用这个方法得到验证码
	public BufferedImage getImage () {
		BufferedImage image = createImage();//创建图片缓冲区 
		Graphics2D g2 = (Graphics2D)image.getGraphics();//得到绘制环境
		StringBuilder sb = new StringBuilder();//用来装载生成的验证码文本
		// 向图片中画4个字符
		for(int i = 0; i < 4; i++)  {//循环四次，每次生成一个字符
			String s = randomChar() + "";//随机生成一个字母 
			sb.append(s); //把字母添加到sb中
			float x = i * 1.0F * w / 4; //设置当前字符的x轴坐标
			g2.setFont(randomFont()); //设置随机字体
			g2.setColor(randomColor()); //设置随机颜色
			g2.drawString(s, x, h-5); //画图
		}
		this.text = sb.toString(); //把生成的字符串赋给了this.text
		drawLine(image); //添加干扰线
		return image;		
	}
	
	// 返回验证码图片上的文本
	public String getText () {
		return text;
	}
	
	// 保存图片到指定的输出流
	public static void output (BufferedImage image, OutputStream out) 
				throws IOException {
		ImageIO.write(image, "JPEG", out);
	}
}

//VerifyCodeServlet.java
package user.web.servlet;

import java.awt.image.BufferedImage;
import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class VerifyCodeServlet extends HttpServlet {
	public void doGet(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {
		/*
		 * 1. 创建验证码类
		 */
		VerifyCode vc = new VerifyCode();
		/*
		 * 2. 得到验证码图片
		 */
		BufferedImage image = vc.getImage();
		/*
		 * 3. 把图片上的文本保存到session中
		 */
		request.getSession().setAttribute("session_vcode", vc.getText());
		/*
		 * 4. 把图片响应给客户端
		 */
		VerifyCode.output(image, response.getOutputStream());
	}
}

//regist.jsp
<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>


<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <title>My JSP 'regist.jsp' starting page</title>
    
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="expires" content="0">    
	<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
	<meta http-equiv="description" content="This is my page">
	<!--
	<link rel="stylesheet" type="text/css" href="styles.css">
	-->
<script type="text/javascript">
	/*
	如果一个表单项的name和<img>的id相同，那么可能会出问题！一般只有IE出问题！
	*/
	function _change() {
		/*
		1. 获取<img>元素
		*/
		var ele = document.getElementById("vCode");
		ele.src = "<c:url value='/VerifyCodeServlet'/>?xxx=" + new Date().getTime();
		
	}
</script>
  </head>
  
  <body>
<h1>注册</h1>
<p style="color: red; font-weight: 900">${msg }</p>
<%--${pageContext.request.contextPath }/RegistServlet --%>
<form action="<c:url value='/RegistServlet'/>" method="post">
  用户名：<input type="text" name="username" value="${user.username }"/>${errors.username }<br/>
  密　码：<input type="password" name="password" value="${user.password }"/>${errors.password }<br/>
  验证码：<input type="text" name="verifyCode" value="${user.verifyCode }" size="3"/>
        <img id="vCode" src="<c:url value='/VerifyCodeServlet'/>" border="2"/>
        <a href="javascript:_change()">换一张</a>${errors.verifyCode }<br/>
  <input type="submit" value="注册"/>
</form>
  </body>
</html>

//login.jsp
<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%
	String path = request.getContextPath();
	String basePath = request.getScheme() + "://" + request.getServerName() + ":" + request.getServerPort()
			+ path + "/";
%>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<base href="<%=basePath%>">

<title>My JSP 'login.jsp' starting page</title>

<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
<meta http-equiv="description" content="This is my page">
<!--
	<link rel="stylesheet" type="text/css" href="styles.css">
	-->

</head>

<body>
	<h1>登錄</h1>
	<form action="<c:url value='/LoginServlet'/>" method="post">
		用户名：<input type="text" name="username" value="${user.username }" /><br />
		密 码：<input type="password" name="password" value="${user.password }" /><br />
		<input type="submit" value="登錄"/>
	</form>
</body>
</html>

//welcome.jsp
<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%
String path = request.getContextPath();
String basePath = request.getScheme()+"://"+request.getServerName()+":"+request.getServerPort()+path+"/";
%>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
  <head>
    <base href="<%=basePath%>">
    
    <title>My JSP 'welcome.jsp' starting page</title>
    
	<meta http-equiv="pragma" content="no-cache">
	<meta http-equiv="cache-control" content="no-cache">
	<meta http-equiv="expires" content="0">    
	<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
	<meta http-equiv="description" content="This is my page">
	<!--
	<link rel="stylesheet" type="text/css" href="styles.css">
	-->

  </head>
  
  <body>
  	<h1>歡迎登錄本系統</h1>
  	<c:choose>
  		<c:when test="${empty sessionScope.sessionUser }">滾!</c:when>
  		<c:otherwise>
  			${sessionScope.sessionUser }
  		</c:otherwise>
  	</c:choose>
  </body>
</html>
```
